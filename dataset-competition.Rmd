---
title: "Ceng 574 - Dataset Competition"
author: "Mehmet Gencol - Mustafa Murat Co�kun - �nder �lke Sever"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(clusterGeneration)
library(MASS)
library(clusterGeneration)
library(apcluster)
library(smacof)
library(ProjectionBasedClustering)
library(ecodist)
library(vegan)
library(factoextra)
library(MASS)
library(clusterGeneration)
library(apcluster)
library(ProjectionBasedClustering)
library(ecodist)
library(vegan)
library(factoextra)
library(cluster)
library(clValid)

```

# 1) Preprocessing
```{r}
f.path = "DataSet-2018-final.csv"
d.data <- df <- read.csv(file=f.path, header=FALSE, sep=";")[,c(1,2,3,5,6,7,8,9,10,11,12,15,16)]
t.data <- df <- read.csv(file=f.path, header=FALSE, sep=";")[,c(4,13,14,17)]
t.data <- sapply(t.data, function(v) {as.numeric(gsub("\\.","", as.character(v)))})

o.data <- cbind(d.data, t.data)
o.data = na.omit(o.data)
row_sub = apply(o.data, 1, function(row) all(row !=0 ))
o.data[row_sub,]
o.matrix = data.matrix(o.data)
s.data = scale(o.matrix)
sep_data = s.data
```


# 2) Clustering

## i) Without Dimensity Reduction
```{r}
distance_matrix <- dist(sep_data, method = "euclidean") # distance matrix

dunn <- clValid(sep_data, 2:20, clMethods=c("kmeans"), validation="internal")
plot(dunn)
```


## ii) with Dimensity Reduction using PCA

```{r}
pc.cr <- prcomp(sep_data)
screeplot(pc.cr)

propVar<-(pc.cr$sdev)^2 / sum(pc.cr$sdev^2)
barplot(propVar,main = "Proportion of Variance")
```

### Data Representation On 2-d Using First Two Principle
```{r}
library(ggfortify)
autoplot(prcomp(sep_data))
```

```{r}
sep_data_lin_reduc = prcomp(sep_data)

dunn <- clValid(sep_data_lin_reduc$x[,1:17], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)

dunn <- clValid(sep_data_lin_reduc$x[,1:13], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)

dunn <- clValid(sep_data_lin_reduc$x[,1:5], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)

dunn <- clValid(sep_data_lin_reduc$x[,1:2], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)
```
```{r}
dunn <- clValid(sep_data_lin_reduc$x[,1:11], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)

dunn <- clValid(sep_data_lin_reduc$x[,1:12], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)

dunn <- clValid(sep_data_lin_reduc$x[,1:13], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)

dunn <- clValid(sep_data_lin_reduc$x[,1:14], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)

dunn <- clValid(sep_data_lin_reduc$x[,1:15], 10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
summary(dunn)
```



# 3) Validation

