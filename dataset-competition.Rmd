---
title: "Ceng 574 - Dataset Competition"
author: "Mehmet Gencol - Mustafa Murat Co�kun - �nder �lke Sever"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(clusterGeneration)
library(MASS)
library(clusterGeneration)
library(apcluster)
library(smacof)
library(ProjectionBasedClustering)
library(ecodist)
library(vegan)
library(factoextra)
library(MASS)
library(clusterGeneration)
library(apcluster)
library(ProjectionBasedClustering)
library(ecodist)
library(vegan)
library(factoextra)
library(cluster)
library(clValid)
data1 =genRandomClust(numClust=3, sepVal=0.7, numNonNoisy=4, clustszind=3, clustSizes=c(20,20,20))
sep_data <- data1$datList$test_1



```

# 1) Preprocessing
```{r}
f.path = "DataSet-2018-final.csv"
d.data <- df <- read.csv(file=f.path, header=FALSE, sep=";")[,c(1,2,3,5,6,7,8,9,10,11,12,15,16)]
t.data <- df <- read.csv(file=f.path, header=FALSE, sep=";")[,c(4,13,14,17)]
t.data <- sapply(t.data, function(v) {as.numeric(gsub("\\.","", as.character(v)))})

o.data <- cbind(d.data, t.data)
o.data = na.omit(o.data)
row_sub = apply(o.data, 1, function(row) all(row !=0 ))
o.data[row_sub,]
o.matrix = data.matrix(o.data)
s.data = scale(o.matrix)
sep_data = s.data
```


# 2) Clustering

## i) Without Dimensity Reduction
```{r}
distance_matrix <- dist(sep_data, method = "euclidean") # distance matrix
fit_sep_data <- hclust(distance_matrix, method="average")

set.seed(123)
kmeans_sep_data <- kmeans(sep_data, 10, nstart = 25)

plot(fit_sep_data)
rect.hclust(fit_sep_data, k = 10, border = 2:5)

sub_grp <- cutree(fit_sep_data, k = 10)
fviz_cluster(list(data = sep_data, cluster = sub_grp))

fviz_cluster(kmeans_sep_data, data = sep_data)


silhouette_sep_data <- silhouette(kmeans_sep_data$cluster, dist(sep_data))
plot(silhouette_sep_data)

#dunn <- clValid(sep_data, 2:20, clMethods=c("kmeans"), validation="internal")
#plot(dunn)
```


## ii) with Dimensity Reduction

### a) Linear Projection
```{r}
pc.cr <- prcomp(sep_data)
screeplot(pc.cr)

propVar<-(pc.cr$sdev)^2 / sum(pc.cr$sdev^2)
barplot(propVar,main = "Proportion of Variance")

sep_data_lin_reduc = prcomp(sep_data)

dunn <- clValid(sep_data_lin_reduc$x[,1:3], 5:10, clMethods=c("kmeans"), validation="internal")
plot(dunn)
```

```{r}
sep_data_lin_reduc = prcomp(sep_data)

set.seed(123)
l_kmeans_sep_data <- kmeans(sep_data_lin_reduc$x[,1:3], 3, nstart = 25)

fviz_cluster(l_kmeans_sep_data, data = sep_data)

l_silhouette_sep_data <- silhouette(l_kmeans_sep_data$cluster, dist(sep_data))
plot(l_silhouette_sep_data)

```

### b) Non Linear Projection

```{r}

nl_sep_data.x <- sep_data
nl_sep_data.dist <- dist(sep_data.x)
nl_sep_data.mds <- isoMDS(sep_data.dist)
plot(nl_sep_data.mds$points, type = "n")
text(nl_sep_data.mds$points, labels = as.character(1:nrow(sep_data.x)))

set.seed(123)
nl_kmeans_sep_data <- kmeans(nl_sep_data.mds$points, 3, nstart = 25)

fviz_cluster(nl_kmeans_sep_data, data = sep_data)

nl_silhouette_sep_data <- silhouette(nl_kmeans_sep_data$cluster, dist(sep_data))
plot(nl_silhouette_sep_data)
```

# 3) Validation

